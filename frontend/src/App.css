/* --- Переменные цветов iOS Dark Mode --- */
:root {
  --ios-bg: #000000;
  --ios-bar-bg: rgba(30, 30, 30, 0.75); /* Полупрозрачный фон для размытия */
  --ios-separator: #38383A;
  --ios-blue: #0A84FF;
  --ios-text-primary: #FFFFFF;
  --ios-text-secondary: #8E8E93;
  --ios-bubble-user: #0A84FF;
  --ios-bubble-bot: #262628;
  --ios-input-bg: #1C1C1E;
}

/* --- Базовые настройки --- */
* {
  box-sizing: border-box;
  -webkit-tap-highlight-color: transparent;
  /* Используем системный шрифт Apple */
  font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", sans-serif;
}

html, body, #root {
  height: 100dvh; /* Фиксация высоты на мобильных */
  margin: 0;
  padding: 0;
  background-color: var(--ios-bg);
  color: var(--ios-text-primary);
  overflow: hidden; /* Запрет прокрутки всего тела */
}

.app-container {
  display: flex;
  flex-direction: column;
  height: 100%;
  max-width: 600px; /* Ограничение ширины для планшетов/ПК */
  margin: 0 auto;
  position: relative;
  background: var(--ios-bg);
}

/* --- Шапка (Header) в стиле iOS --- */
.header {
  /* Учет безопасной зоны сверху (челка iPhone) */
  padding-top: calc(env(safe-area-inset-top) + 10px);
  padding-bottom: 12px;
  padding-left: 8px;
  padding-right: 8px;
  
  background: var(--ios-bar-bg);
  /* Эффект матового стекла */
  backdrop-filter: blur(25px) saturate(150%);
  -webkit-backdrop-filter: blur(25px) saturate(150%);
  border-bottom: 0.5px solid var(--ios-separator);
  
  display: flex;
  align-items: center;
  z-index: 10;
  position: absolute; /* Фиксация поверх чата */
  top: 0;
  left: 0;
  right: 0;
}

/* Кнопка "Назад" (визуальная) */
.header-back {
  color: var(--ios-blue);
  font-size: 17px;
  display: flex;
  align-items: center;
  padding-left: 5px;
  width: 80px; /* Фиксированная ширина для центрирования заголовка */
}
.header-back span { font-size: 24px; margin-top: -3px; margin-right: 3px; }

/* Центральный заголовок */
.header-title {
  flex: 1;
  text-align: center;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.bar-name { font-size: 17px; font-weight: 600; }
.bar-status { font-size: 12px; color: var(--ios-text-secondary); margin-top: 2px;}

/* Заглушка справа для баланса */
.header-right { width: 80px; text-align: right; }


/* --- Область чата --- */
.chat-window {
  flex: 1;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch; /* Плавный скролл на iOS */
  padding: 15px;
  /* Отступы под шапку и подвал */
  padding-top: 100px; 
  padding-bottom: 20px;
  display: flex;
  flex-direction: column;
  gap: 8px; /* Расстояние между сообщениями */
}

/* Анимация появления */
@keyframes popIn {
    from { opacity: 0; transform: scale(0.9) translateY(10px); }
    to { opacity: 1; transform: scale(1) translateY(0); }
}

.message {
  max-width: 75%;
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.4;
  position: relative;
  animation: popIn 0.25s cubic-bezier(0.25, 1, 0.5, 1) forwards;
  word-wrap: break-word;
}

/* Сообщение бота (серое слева) */
.bot {
  align-self: flex-start;
  background-color: var(--ios-bubble-bot);
  color: var(--ios-text-primary);
  /* Закругление с хвостиком слева внизу */
  border-radius: 20px 20px 20px 5px; 
  margin-left: 5px;
}

/* Сообщение пользователя (синее справа) */
.user {
  align-self: flex-end;
  background-color: var(--ios-bubble-user);
  color: white;
  /* Закругление с хвостиком справа внизу */
  border-radius: 20px 20px 5px 20px;
  margin-right: 5px;
}


/* --- Панель ввода (Input Bar) --- */
.input-area {
  /* Учет безопасной зоны снизу (полоска Home) */
  padding: 10px 15px calc(10px + env(safe-area-inset-bottom));
  
  background: var(--ios-bar-bg);
  /* Эффект матового стекла */
  backdrop-filter: blur(25px) saturate(150%);
  -webkit-backdrop-filter: blur(25px) saturate(150%);
  border-top: 0.5px solid var(--ios-separator);
  
  display: flex;
  align-items: flex-end;
  gap: 12px;
  z-index: 10;
}

/* Серая пилюля для ввода */
.input-wrapper {
  flex: 1;
  background: var(--ios-input-bg);
  border-radius: 20px;
  border: 0.5px solid rgba(255,255,255,0.1);
  padding: 8px 15px;
  display: flex;
  align-items: center;
  min-height: 38px;
}

input {
  flex: 1;
  background: transparent;
  border: none;
  color: var(--ios-text-primary);
  font-size: 17px;
  padding: 0;
  margin: 0;
  outline: none;
}

input::placeholder { color: var(--ios-text-secondary); }

/* Кнопка отправки (стрелка вверх) */
.send-btn {
  width: 34px;
  height: 34px;
  background-color: var(--ios-blue);
  border-radius: 50%;
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 20px;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.2s ease;
  padding-bottom: 2px; /* Корректировка положения стрелки */
}

/* Неактивная кнопка */
.send-btn:disabled {
  background-color: var(--ios-input-bg);
  color: var(--ios-text-secondary);
}
